<html>

<head>

<link rel="stylesheet" type="text/css" href="./node_modules/bulma/css/bulma.css">
<script src="https://cdn.jsdelivr.net/npm/vue"></script>
<script defer src="https://use.fontawesome.com/releases/v5.0.6/js/all.js"></script>

</head>

<body>

  <div id="app">
  <section class="hero is-primary">
  <div class="hero-body">
    <div class="container">
      <h1 class="title">
        {{ message }}
      </h1>
    </div>
  </div>
</section>

  <div v-if="!room_id" class="container has-text-centered">
  <!-- Button -->
  <br><br><br><a v-on:click="invite"
  class="button is-medium is-primary">Invite Peer</a>

  <!-- product copy -->
  <p><br><br>This is a secure app to transfer files from peer to peer.</p>
  <p><br>There is NO third party and NO security risk!</p>
  <p><br>Click the button to send an email invitation to the file recipient!</p>

  </div>

  <!-- Stuff to show after room id is generated -->
  <div v-if="room_id" class="container has-text-centered">

  <p><br><br><br>Waiting on peer to respond!<br><br><br></p>

  <!-- Spinner icon -->
  <span class="icon is-large has-text-primary">
    <i class="fas fa-spinner fa-3x fa-pulse"></i>
  </span>

  </div>

</div>

<!-- Vue app stuff -->
  <script>
  var app = new Vue({
    el: '#app',
    data: {
      message: 'File Transfer',
      room_id: null
    },
    methods: {
      invite: function(event) {
        this.room_id = Math.random().toString();
        const url =`Join transfer: ${window.location}rooms/${this.room_id}`;
        //console.log(url);
        const body = encodeURI(`Hello,\n\n I would like to send you a file using File Transfer, a secure website for peer-to-peer file transfers. Please click the invite link below to complete the transfer!\n\n${url}\n\nThank you!`);
        const subject = "File Transfer Request";
        event.srcElement.href=`mailto:user@example.com?subject=${subject}&body=${body}`;
        //console.log(body)
        //console.log(event.srcElement.href);
      }
    }
  })
  </script>



</body>
</html>
